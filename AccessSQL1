# To i) compute profit factor from different product types (divided by sales department) of individual transactions; and ii) masagae to correct critical errors from the raw data

SELECT TILL_RECEIPT_NUMBER & "_" & TRANSACTION_DATE AS Unique_Trac, SUM(SALES_VALUE) AS Sales, SUM(COST_AMOUNT) AS Cost, SUM(SALES_VALUE - COST_AMOUNT) AS Profit, SUM(IIF(sub_department in (94), sales_value, NULL)) AS Total_sub94, SUM(IIF(sub_department in (1), sales_value, NULL)) AS Total_sub1, SUM(IIF(sub_department in (7), sales_value, NULL)) AS Total_sub7, SUM(IIF(sub_department in (6), sales_value, NULL)) AS Total_sub6, SUM(IIF(sub_department in (3), sales_value, NULL)) AS Total_sub3, SUM(IIF(sub_department in (44), sales_value, NULL)) AS Total_sub44, SUM(IIF(sub_department in (78), sales_value, NULL)) AS Total_sub78, SUM(IIF(sub_department in (80), sales_value, NULL)) AS Total_sub80, SUM(IIF(sub_department in (67), sales_value, NULL)) AS Total_sub67, SUM(IIF(sub_department in (22), sales_value, NULL)) AS Total_sub22, SUM(IIF(sub_department in (30), sales_value, NULL)) AS Total_sub30, SUM(IIF(sub_department in (97), sales_value, NULL)) AS Total_sub97, SUM(IIF(sub_department in (0), sales_value, NULL)) AS Total_sub0, SUM(IIF(sub_department in (4), sales_value, NULL)) AS Total_sub4, SUM(IIF(sub_department in (51), sales_value, NULL)) AS Total_sub51, SUM(IIF(sub_department in (50), sales_value, NULL)) AS Total_sub50, SUM(IIF(sub_department in (46), sales_value, NULL)) AS Total_sub46, SUM(IIF(sub_department in (98), sales_value, NULL)) AS Total_sub98, SUM(IIF(sub_department in (23), sales_value, NULL)) AS Total_sub23, SUM(IIF(sub_department in (32), sales_value, NULL)) AS Total_sub32, SUM(IIF(sub_department in (20), sales_value, NULL)) AS Total_sub20, SUM(IIF(sub_department in (40), sales_value, NULL)) AS Total_sub40, SUM(IIF(sub_department in (96), sales_value, NULL)) AS Total_sub96, SUM(IIF(sub_department in (28), sales_value, NULL)) AS Total_sub28, SUM(IIF(sub_department in (41), sales_value, NULL)) AS Total_sub41, SUM(IIF(sub_department in (69), sales_value, NULL)) AS Total_sub69, SUM(IIF(sub_department in (68), sales_value, NULL)) AS Total_sub68, SUM(IIF(sub_department in (26), sales_value, NULL)) AS Total_sub26, SUM(IIF(sub_department in (33), sales_value, NULL)) AS Total_sub33, SUM(IIF(sub_department in (93), sales_value, NULL)) AS Total_sub93, SUM(IIF(sub_department in (86), sales_value, NULL)) AS Total_sub86, SUM(IIF(sub_department in (90), sales_value, NULL)) AS Total_sub90, SUM(IIF(sub_department in (45), sales_value, NULL)) AS Total_sub45, SUM(IIF(sub_department in (60), sales_value, NULL)) AS Total_sub60, SUM(IIF(sub_department in (91), sales_value, NULL)) AS Total_sub91, SUM(IIF(sub_department in (89), sales_value, NULL)) AS Total_sub89, SUM(IIF(sub_department in (15), sales_value, NULL)) AS Total_sub15, SUM(IIF(sub_department in (29), sales_value, NULL)) AS Total_sub29, SUM(IIF(sub_department in (75), sales_value, NULL)) AS Total_sub75, SUM(IIF(sub_department in (79), sales_value, NULL)) AS Total_sub79, SUM(IIF(sub_department in (131), sales_value, NULL)) AS Total_sub131, SUM(IIF(sub_department in (21), sales_value, NULL)) AS Total_sub21, SUM(IIF(sub_department in (201), sales_value, NULL)) AS Total_sub201, SUM(IIF(sub_department in (71), sales_value, NULL)) AS Total_sub71, SUM(IIF(sub_department in (25), sales_value, NULL)) AS Total_sub25, SUM(IIF(sub_department in (206), sales_value, NULL)) AS Total_sub206, SUM(IIF(sub_department in (210), sales_value, NULL)) AS Total_sub210, SUM(IIF(sub_department in (81), sales_value, NULL)) AS Total_sub81, SUM(IIF(sub_department in (92), sales_value, NULL)) AS Total_sub92, SUM(IIF(sub_department in (87), sales_value, NULL)) AS Total_sub87, SUM(IIF(sub_department in (160), sales_value, NULL)) AS Total_sub160, SUM(IIF(sub_department in (72), sales_value, NULL)) AS Total_sub72, SUM(IIF(sub_department in (161), sales_value, NULL)) AS Total_sub161, SUM(IIF(sub_department in (130), sales_value, NULL)) AS Total_sub130, SUM(IIF(sub_department in (42), sales_value, NULL)) AS Total_sub42, SUM(IIF(sub_department in (88), sales_value, NULL)) AS Total_sub88, SUM(IIF(sub_department in (70), sales_value, NULL)) AS Total_sub70, SUM(IIF(sub_department in (83), sales_value, NULL)) AS Total_sub83, SUM(IIF(sub_department in (43), sales_value, NULL)) AS Total_sub43, SUM(IIF(sub_department in (34), sales_value, NULL)) AS Total_sub34, SUM(IIF(sub_department in (24), sales_value, NULL)) AS Total_sub24, SUM(IIF(sub_department in (95), sales_value, NULL)) AS Total_sub95, SUM(IIF(sub_department in (215), sales_value, NULL)) AS Total_sub215, SUM(IIF(sub_department in (76), sales_value, NULL)) AS Total_sub76, SUM(IIF(sub_department in (73), sales_value, NULL)) AS Total_sub73, SUM(IIF(sub_department in (74), sales_value, NULL)) AS Total_sub74, SUM(IIF(sub_department in (208), sales_value, NULL)) AS Total_sub208, SUM(IIF(sub_department in (77), sales_value, NULL)) AS Total_sub77, SUM(IIF(sub_department in (121), sales_value, NULL)) AS Total_sub121, SUM(IIF(sub_department in (122), sales_value, NULL)) AS Total_sub122, SUM(IIF(sub_department in (63), sales_value, NULL)) AS Total_sub63, SUM(IIF(sub_department in (216), sales_value, NULL)) AS Total_sub216, SUM(IIF(sub_department in (62), sales_value, NULL)) AS Total_sub62, SUM(IIF(sub_department in (61), sales_value, NULL)) AS Total_sub61, SUM(IIF(sub_department in (204), sales_value, NULL)) AS Total_sub204, SUM(IIF(sub_department in (207), sales_value, NULL)) AS Total_sub207, SUM(IIF(sub_department in (84), sales_value, NULL)) AS Total_sub84, SUM(IIF(sub_department in (17), sales_value, NULL)) AS Total_sub17, SUM(IIF(sub_department in (194), sales_value, NULL)) AS Total_sub194, SUM(IIF(sub_department in (192), sales_value, NULL)) AS Total_sub192, SUM(IIF(sub_department in (35), sales_value, NULL)) AS Total_sub35, SUM(IIF(sub_department in (190), sales_value, NULL)) AS Total_sub190, SUM(IIF(sub_department in (27), sales_value, NULL)) AS Total_sub27, SUM(IIF(sub_department in (170), sales_value, NULL)) AS Total_sub170, SUM(IIF(sub_department in (172), sales_value, NULL)) AS Total_sub172, SUM(IIF(sub_department in (16), sales_value, NULL)) AS Total_sub16
FROM transactionsT
GROUP BY TILL_RECEIPT_NUMBER & "_" & TRANSACTION_DATE;
